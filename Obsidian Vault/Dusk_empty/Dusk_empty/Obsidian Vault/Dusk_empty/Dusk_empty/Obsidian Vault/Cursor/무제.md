
# ì˜µì‹œë””ì–¸ì—ì„œ ì›ë“œë¼ì´ë¸Œ íŒŒì¼ ë³´ê¸° (ì½”ë”© ë°©ì‹)

ë‹¤ìŒì€ ì˜µì‹œë””ì–¸ì—ì„œ ì›ë“œë¼ì´ë¸Œ íŒŒì¼ì„ ì§ì ‘ ë³¼ ìˆ˜ ìˆëŠ” ê°„ë‹¨í•œ HTML íŒŒì¼ê³¼ ìŠ¤í¬ë¦½íŠ¸ì…ë‹ˆë‹¤. ì´ˆë“±í•™ìƒë„ ë”°ë¼í•  ìˆ˜ ìˆê²Œ ìƒì„¸íˆ ì„¤ëª…í•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤.

## 1ë‹¨ê³„: í•„ìš”í•œ íŒŒì¼ ë§Œë“¤ê¸°

1. ë©”ëª¨ì¥ ì—´ê¸° 
2. ì•„ë˜ ì½”ë“œë¥¼ ë³µì‚¬í•´ì„œ ë¶™ì—¬ë„£ê¸°:

```html
<!DOCTYPE html>
<html>
<head>
    <title>ì›ë“œë¼ì´ë¸Œ íŒŒì¼ ë³´ê¸°</title>
    <style>
        body { font-family: Arial; margin: 20px; }
        button { padding: 10px; background: #0078d4; color: white; border: none; border-radius: 5px; cursor: pointer; }
        input { padding: 8px; width: 300px; }
        #fileList { margin-top: 20px; }
        .file-item { padding: 10px; border-bottom: 1px solid #eee; cursor: pointer; }
        .file-item:hover { background-color: #f5f5f5; }
        #viewer { margin-top: 20px; border: 1px solid #ddd; min-height: 400px; padding: 10px; }
    </style>
</head>
<body>
    <h1>ìš°ë¦¬ì§‘ ì›ë“œë¼ì´ë¸Œ íŒŒì¼</h1>
    
    <button id="loginButton">ë§ˆì´í¬ë¡œì†Œí”„íŠ¸ ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸</button>
    <div id="userInfo" style="display:none;">
        <p>ë¡œê·¸ì¸ ë¨: <span id="userName"></span></p>
        <button id="logoutButton">ë¡œê·¸ì•„ì›ƒ</button>
    </div>
    
    <div id="searchBox" style="display:none; margin-top: 20px;">
        <input type="text" id="searchInput" placeholder="ì°¾ê³  ì‹¶ì€ íŒŒì¼ ì´ë¦„ ì…ë ¥...">
        <button id="searchButton">ê²€ìƒ‰</button>
    </div>
    
    <div id="fileList"></div>
    <div id="viewer"></div>

    <script src="https://alcdn.msauth.net/browser/2.30.0/js/msal-browser.min.js"></script>
    <script>
        // Microsoft ì¸ì¦ ì„¤ì •
        const msalConfig = {
            auth: {
                clientId: "ì—¬ê¸°ì—_í´ë¼ì´ì–¸íŠ¸_ID_ì…ë ¥",
                authority: "https://login.microsoftonline.com/common",
                redirectUri: window.location.origin + window.location.pathname,
            }
        };

        const msalInstance = new msal.PublicClientApplication(msalConfig);
        let account = null;
        let accessToken = null;

        // ë¡œê·¸ì¸ ë²„íŠ¼
        document.getElementById('loginButton').addEventListener('click', async () => {
            try {
                const loginResponse = await msalInstance.loginPopup({
                    scopes: ["Files.Read", "Files.Read.All", "User.Read"]
                });
                
                account = loginResponse.account;
                await getAccessToken();
                await loadUserInfo();
                
                document.getElementById('loginButton').style.display = 'none';
                document.getElementById('userInfo').style.display = 'block';
                document.getElementById('searchBox').style.display = 'block';
                
                // íŒŒì¼ ëª©ë¡ ë¶ˆëŸ¬ì˜¤ê¸°
                await listFiles();
            } catch (error) {
                alert("ë¡œê·¸ì¸ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: " + error);
            }
        });

        // ë¡œê·¸ì•„ì›ƒ ë²„íŠ¼
        document.getElementById('logoutButton').addEventListener('click', () => {
            msalInstance.logout();
        });

        // ê²€ìƒ‰ ë²„íŠ¼
        document.getElementById('searchButton').addEventListener('click', async () => {
            await searchFiles(document.getElementById('searchInput').value);
        });

        // ì—”í„°í‚¤ë¡œ ê²€ìƒ‰
        document.getElementById('searchInput').addEventListener('keypress', async (e) => {
            if (e.key === 'Enter') {
                await searchFiles(document.getElementById('searchInput').value);
            }
        });

        // ì•¡ì„¸ìŠ¤ í† í° ê°€ì ¸ì˜¤ê¸°
        async function getAccessToken() {
            try {
                const tokenResponse = await msalInstance.acquireTokenSilent({
                    scopes: ["Files.Read", "Files.Read.All", "User.Read"],
                    account: account
                });
                accessToken = tokenResponse.accessToken;
            } catch (error) {
                console.error("í† í° ê°€ì ¸ì˜¤ê¸° ì˜¤ë¥˜:", error);
                try {
                    const tokenResponse = await msalInstance.acquireTokenPopup({
                        scopes: ["Files.Read", "Files.Read.All", "User.Read"]
                    });
                    accessToken = tokenResponse.accessToken;
                } catch (err) {
                    alert("ë¡œê·¸ì¸ ì„¸ì…˜ì´ ë§Œë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”.");
                    msalInstance.logout();
                }
            }
        }

        // ì‚¬ìš©ì ì •ë³´ ê°€ì ¸ì˜¤ê¸°
        async function loadUserInfo() {
            if (!accessToken) await getAccessToken();
            
            try {
                const response = await fetch("https://graph.microsoft.com/v1.0/me", {
                    headers: {
                        "Authorization": `Bearer ${accessToken}`
                    }
                });
                
                if (response.ok) {
                    const user = await response.json();
                    document.getElementById('userName').textContent = user.displayName;
                }
            } catch (error) {
                console.error("ì‚¬ìš©ì ì •ë³´ ê°€ì ¸ì˜¤ê¸° ì˜¤ë¥˜:", error);
            }
        }

        // íŒŒì¼ ëª©ë¡ ê°€ì ¸ì˜¤ê¸°
        async function listFiles() {
            if (!accessToken) await getAccessToken();
            
            try {
                const response = await fetch("https://graph.microsoft.com/v1.0/me/drive/root/children", {
                    headers: {
                        "Authorization": `Bearer ${accessToken}`
                    }
                });
                
                if (response.ok) {
                    const data = await response.json();
                    displayFiles(data.value);
                }
            } catch (error) {
                console.error("íŒŒì¼ ëª©ë¡ ê°€ì ¸ì˜¤ê¸° ì˜¤ë¥˜:", error);
            }
        }

        // íŒŒì¼ ê²€ìƒ‰í•˜ê¸°
        async function searchFiles(searchTerm) {
            if (!accessToken) await getAccessToken();
            if (!searchTerm) {
                await listFiles();
                return;
            }
            
            try {
                const response = await fetch(`https://graph.microsoft.com/v1.0/me/drive/root/search(q='${searchTerm}')`, {
                    headers: {
                        "Authorization": `Bearer ${accessToken}`
                    }
                });
                
                if (response.ok) {
                    const data = await response.json();
                    displayFiles(data.value);
                }
            } catch (error) {
                console.error("íŒŒì¼ ê²€ìƒ‰ ì˜¤ë¥˜:", error);
            }
        }

        // íŒŒì¼ ëª©ë¡ í‘œì‹œí•˜ê¸°
        function displayFiles(files) {
            const fileListElement = document.getElementById('fileList');
            fileListElement.innerHTML = "<h2>íŒŒì¼ ëª©ë¡</h2>";
            
            if (files.length === 0) {
                fileListElement.innerHTML += "<p>íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤.</p>";
                return;
            }
            
            files.forEach(file => {
                const fileItem = document.createElement('div');
                fileItem.className = 'file-item';
                
                // ì•„ì´ì½˜ ì„ íƒ
                let icon = "ğŸ“„";
                if (file.folder) icon = "ğŸ“";
                else if (file.name.endsWith('.jpg') || file.name.endsWith('.png')) icon = "ğŸ–¼ï¸";
                else if (file.name.endsWith('.docx')) icon = "ğŸ“";
                else if (file.name.endsWith('.xlsx')) icon = "ğŸ“Š";
                else if (file.name.endsWith('.pdf')) icon = "ğŸ“‘";
                
                fileItem.innerHTML = `${icon} ${file.name}`;
                
                // í´ë”ì¸ ê²½ìš°
                if (file.folder) {
                    fileItem.addEventListener('click', async () => {
                        await openFolder(file.id);
                    });
                } 
                // íŒŒì¼ì¸ ê²½ìš°
                else {
                    fileItem.addEventListener('click', async () => {
                        await viewFile(file);
                    });
                }
                
                fileListElement.appendChild(fileItem);
            });
        }

        // í´ë” ì—´ê¸°
        async function openFolder(folderId) {
            if (!accessToken) await getAccessToken();
            
            try {
                const response = await fetch(`https://graph.microsoft.com/v1.0/me/drive/items/${folderId}/children`, {
                    headers: {
                        "Authorization": `Bearer ${accessToken}`
                    }
                });
                
                if (response.ok) {
                    const data = await response.json();
                    displayFiles(data.value);
                }
            } catch (error) {
                console.error("í´ë” ì—´ê¸° ì˜¤ë¥˜:", error);
            }
        }

        // íŒŒì¼ ë³´ê¸°
        async function viewFile(file) {
            const viewer = document.getElementById('viewer');
            viewer.innerHTML = `<h3>${file.name} ë‚´ìš©</h3>`;
            
            // ì´ë¯¸ì§€ì¸ ê²½ìš°
            if (file.name.endsWith('.jpg') || file.name.endsWith('.png') || file.name.endsWith('.gif')) {
                await getAccessToken();
                const downloadUrl = file['@microsoft.graph.downloadUrl'];
                viewer.innerHTML += `<img src="${downloadUrl}" style="max-width:100%">`;
            }
            // PDFì¸ ê²½ìš°
            else if (file.name.endsWith('.pdf')) {
                await getAccessToken();
                const downloadUrl = file['@microsoft.graph.downloadUrl'];
                viewer.innerHTML += `<iframe src="${downloadUrl}" width="100%" height="500px"></iframe>`;
            }
            // ë¬¸ì„œ íŒŒì¼ì¸ ê²½ìš°
            else if (file.name.endsWith('.docx') || file.name.endsWith('.xlsx') || file.name.endsWith('.pptx')) {
                viewer.innerHTML += `
                    <p>ì´ íŒŒì¼ì€ í˜„ì¬ ë·°ì–´ì—ì„œ ì§ì ‘ ë³¼ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>
                    <button id="downloadBtn">ë‹¤ìš´ë¡œë“œ</button>
                `;
                document.getElementById('downloadBtn').addEventListener('click', () => {
                    window.open(file['@microsoft.graph.downloadUrl']);
                });
            }
            // í…ìŠ¤íŠ¸ íŒŒì¼ì¸ ê²½ìš°
            else if (file.name.endsWith('.txt')) {
                try {
                    await getAccessToken();
                    const response = await fetch(file['@microsoft.graph.downloadUrl']);
                    if (response.ok) {
                        const text = await response.text();
                        viewer.innerHTML += `<pre>${text}</pre>`;
                    }
                } catch (error) {
                    console.error("í…ìŠ¤íŠ¸ íŒŒì¼ ë³´ê¸° ì˜¤ë¥˜:", error);
                }
            }
            // ê¸°íƒ€ íŒŒì¼
            else {
                viewer.innerHTML += `
                    <p>ì´ íŒŒì¼ í˜•ì‹ì€ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</p>
                    <button id="downloadBtn">ë‹¤ìš´ë¡œë“œ</button>
                `;
                document.getElementById('downloadBtn').addEventListener('click', () => {
                    window.open(file['@microsoft.graph.downloadUrl']);
                });
            }
        }
    </script>
</body>
</html>
```

3. íŒŒì¼ì„ "ì›ë“œë¼ì´ë¸Œë·°ì–´.html"ë¡œ ì €ì¥í•˜ê¸°

## 2ë‹¨ê³„: ë§ˆì´í¬ë¡œì†Œí”„íŠ¸ ì•± ë“±ë¡í•˜ê¸° (í•œ ë²ˆë§Œ í•˜ë©´ ë¨)

1. ì¸í„°ë„· ë¸Œë¼ìš°ì €ì—ì„œ [https://portal.azure.com](https://portal.azure.com) ì—´ê¸°
2. ë§ˆì´í¬ë¡œì†Œí”„íŠ¸ ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸ (ì›ë“œë¼ì´ë¸Œ ê³„ì •)
3. "ì•± ë“±ë¡" ê²€ìƒ‰í•˜ê³  í´ë¦­
4. "ìƒˆ ë“±ë¡" ë²„íŠ¼ í´ë¦­
5. ì´ë¦„ì— "ì›ë“œë¼ì´ë¸Œë·°ì–´" ì…ë ¥
6. ë¦¬ë””ë ‰ì…˜ URIì— "http://localhost:8080/ì›ë“œë¼ì´ë¸Œë·°ì–´.html" ì…ë ¥
7. "ë“±ë¡" ë²„íŠ¼ í´ë¦­
8. ìƒì„±ëœ "ì• í”Œë¦¬ì¼€ì´ì…˜(í´ë¼ì´ì–¸íŠ¸) ID" ë³µì‚¬í•˜ê¸°

## 3ë‹¨ê³„: HTML íŒŒì¼ ìˆ˜ì •í•˜ê¸°

1. ì €ì¥í•œ "ì›ë“œë¼ì´ë¸Œë·°ì–´.html" íŒŒì¼ì„ ë©”ëª¨ì¥ìœ¼ë¡œ ë‹¤ì‹œ ì—´ê¸°
2. "ì—¬ê¸°ì—_í´ë¼ì´ì–¸íŠ¸_ID_ì…ë ¥" ë¶€ë¶„ì„ ì°¾ì•„ì„œ ë³µì‚¬í•œ IDë¡œ ë°”ê¾¸ê¸°
3. íŒŒì¼ ì €ì¥í•˜ê¸°

## 4ë‹¨ê³„: ê°„ë‹¨í•œ ì›¹ ì„œë²„ ì‹¤í–‰í•˜ê¸°

1. ê°„ë‹¨í•œ ì›¹ ì„œë²„ ë‹¤ìš´ë¡œë“œ: [https://github.com/ritwickdey/vscode-live-server](https://github.com/ritwickdey/vscode-live-server)ì—ì„œ Live Server í™•ì¥ í”„ë¡œê·¸ë¨ ë‹¤ìš´ë¡œë“œ
2. ë˜ëŠ” Pythonì´ ì„¤ì¹˜ë˜ì–´ ìˆë‹¤ë©´ ëª…ë ¹ í”„ë¡¬í”„íŠ¸ì—ì„œ:
   - "ì›ë“œë¼ì´ë¸Œë·°ì–´.html" íŒŒì¼ì´ ìˆëŠ” í´ë”ë¡œ ì´ë™
   - `python -m http.server 8080` ëª…ë ¹ ì‹¤í–‰

## 5ë‹¨ê³„: ì˜µì‹œë””ì–¸ì— ì—°ê²°í•˜ê¸°

1. ì˜µì‹œë””ì–¸ ì—´ê¸°
2. ìƒˆ ë…¸íŠ¸ ë§Œë“¤ê¸°
3. ì•„ë˜ ë‚´ìš© ì¶”ê°€:
```markdown
# ì›ë“œë¼ì´ë¸Œ íŒŒì¼ ë³´ê¸°

<iframe src="http://localhost:8080/ì›ë“œë¼ì´ë¸Œë·°ì–´.html" width="100%" height="700px"></iframe>
```

4. ì €ì¥í•˜ê¸°

## ì‚¬ìš© ë°©ë²•

1. ì›¹ ì„œë²„ ì‹¤í–‰í•˜ê¸°
2. ì˜µì‹œë””ì–¸ì—ì„œ ë§Œë“  ë…¸íŠ¸ ì—´ê¸°
3. "ë§ˆì´í¬ë¡œì†Œí”„íŠ¸ ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸" ë²„íŠ¼ í´ë¦­
4. íŒì—… ì°½ì—ì„œ ë¡œê·¸ì¸
5. ì›ë“œë¼ì´ë¸Œ íŒŒì¼ ëª©ë¡ì´ í‘œì‹œë¨
6. íŒŒì¼ì„ í´ë¦­í•˜ë©´ ë‚´ìš©ì´ ë³´ì„
7. ê²€ìƒ‰ì°½ì— íŒŒì¼ ì´ë¦„ ì…ë ¥í•´ì„œ ì°¾ê¸° ê°€ëŠ¥

ì´ ë°©ë²•ì„ ì‚¬ìš©í•˜ë©´ í”ŒëŸ¬ê·¸ì¸ ì—†ì´ë„ ì›ë“œë¼ì´ë¸Œ íŒŒì¼ì„ ì˜µì‹œë””ì–¸ì—ì„œ ì§ì ‘ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤!
